
<% content_for(:title, t('.title')) %>
<div class="max767-container"> 
  <div class="item-show-space">

    <div class="user-show-name-contents">


      <div class="section-title logo-transform-form-card" style="margin-top: -1rem; margin-bottom: -1rem;">
        <div class="app-logo">
          <div class="flex flex-animated-text">
            <div class="flex-between flex-animated-text-absolute logo-blur-05">
              <div class="animated-text">
                <span class='zen-antique logo-setting'>F</span>
                <span class='sawarabi-mincho logo-setting'>l</span>
                <span class="logo-setting">o</span>
                <span class='dotgothic16'>w</span>

                <span class='potta-one logo-setting-t logo-setting'>T</span>
                <span class='rocknroll-one logo-setting-hi'>h</span>
                <span class='yuji-mai logo-setting-hi'>i</span>
                <span class='yuji-syuku logo-setting-n'>n</span>
              </div>
              <div class="mirror-horizontal animated-text-hanntenn"><p class='slackside-one'>g</p></div>
            </div>

            <div class="flex-between logo-blur-15">
              <div class="animated-text">
                <span class='zen-antique logo-setting'>F</span>
                <span class='sawarabi-mincho logo-setting'>l</span>
                <span class="logo-setting">o</span>
                <span class='dotgothic16'>w</span>

                <span class='potta-one logo-setting-t logo-setting'>T</span>
                <span class='rocknroll-one logo-setting-hi'>h</span>
                <span class='yuji-mai logo-setting-hi'>i</span>
                <span class='yuji-syuku logo-setting-n'>n</span>
              </div>
              <div class="mirror-horizontal animated-text-hanntenn"><p class='slackside-one'>g</p></div>
            </div>
          </div>
        </div>
      </div>


      <span class="f-text sub-name-text"><%= @item.item_name.present? ? @item.item_name : 'No Name' %></span>



    </div>


    <div class="item-icon-frame">
      <% if @item.image_choice.present? %>
        <% case @item.image_choice %>
          <% when 'item_image' %>
            <% if @item.item_image.present? %>
              <%= image_tag @item.item_image.url, class: "item-show-imageicon" %>
            <% end %>
          <% when 'item_canvas' %>
            
              <img src="<%= @item.item_canvas %>" alt="Canvas Image" style="object-fit: contain;" class="item-show-imageicon">
          
          <% else %>
            <div class="no-image-icon">No Image</div>
        <% end %>
      <% end %>
    </div>



    <div class="content motto-miru user-show-comment-contents">
      <span class="comment-text"><i class="bi bi-film"></i>詳細</span><br>

      <span class="comment-text"><i class="bi bi-film"></i>作成日時</span><br>
      <span><%= @item.created_at.strftime("%Y年%m月%d日 %H:%M") %></span><br>
      <span><%= @item.updated_at.strftime("%Y年%m月%d日 %H:%M") %></span><br>

      <span class="comment-text"><i class="bi bi-film"></i>サイズ</span>
      <% if @item.canvas_size.present? %>
        <% canvas_size = JSON.parse(@item.canvas_size) %>
        <p>幅: <%= canvas_size['width'] %>px　／　高さ: <%= canvas_size['height'] %>px</p>
      <% else %>
        <p>幅: 400px</p>
        <p>高さ: 40px</p>
      <% end %>
    </div>

    <div class="content motto-miru user-show-comment-contents">
      <span class="comment-text"><i class="bi bi-tag-fill"></i>コメント</span>
      <% text = @item.item_text.present? ? @item.item_text.to_s : 'No Comment' %>
      <% lines = text.split("\n") %>
      <% preview_text = lines.first(3).join("\n") %>
      <% preview_text = preview_text.length > 80 ? preview_text.first(80) : preview_text %>
      <% if text.length > 80 or lines.length > 3 %>
        <span class="default-view">
          <%= simple_format(preview_text + '。。。') %>
        </span>
        <span class="hidden-view" style="display: none;">
          <%= simple_format text %>
        </span>
        <div class="toggle-view">もっと見る</div>
      <% else %>
        <span>
          <%= simple_format text %>
        </span>
      <% end %>
    </div>



    <div class="content motto-miru user-show-comment-contents">
      <span class="comment-text"><i class="bi bi-film"></i>場所</span>
      <% text = @item.item_place.present? ? @item.item_place : 'none' %>
      <% lines = text.split("\n") %>
      <% preview_text = lines.first(3).join("\n") %>
      <% preview_text = preview_text.length > 80 ? preview_text.first(80) : preview_text %>
      <% if text.length > 80 or lines.length > 3 %>
        <span class="default-view">
          <%= simple_format(preview_text + '。。。') %>
        </span>
        <span class="hidden-view" style="display: none;">
          <%= simple_format text %>
        </span>
        <div class="toggle-view">もっと見る</div>
      <% else %>
        <span>
          <%= simple_format text %>
        </span>
      <% end %>
    </div>


    <div class="content motto-miru user-show-comment-contents">
      <span class="comment-text"><i class="bi bi-film"></i>エピソード</span>
      <% text = @item.episode.present? ? @item.episode : 'No Episode' %>
      <% lines = text.split("\n") %>
      <% preview_text = lines.first(3).join("\n") %>
      <% preview_text = preview_text.length > 80 ? preview_text.first(80) : preview_text %>
      <% if text.length > 80 or lines.length > 3 %>
        <span class="default-view">
          <%= simple_format(preview_text + '。。。') %>
        </span>
        <span class="hidden-view" style="display: none;">
          <%= simple_format text %>
        </span>
        <div class="toggle-view">もっと見る</div>
      <% else %>
        <span>
          <%= simple_format text %>
        </span>
      <% end %>
    </div>

        
    <div class="sub-user-space">
      <% if @sub_user.icon_choice.present? %>
        <%= link_to sub_user_path(@item.sub_user) do %>
        <div class="item-link-btn">

    <div class="section-title logo-transform-item-card">
      <div class="app-logo">
        <div class="flex flex-animated-text">
          <div class="flex-between flex-animated-text-absolute logo-blur-05">
            <div class="animated-text-sub-thing">
              <span class='zen-antique logo-setting'>S</span>
              <span class='sawarabi-mincho logo-setting'>u</span>
              <span class='dotgothic16'>b</span>
              <%# <span class='dotgothic16'>w</span> %>

              <span class='potta-one logo-setting-t logo-setting'>T</span>
              <span class='rocknroll-one logo-setting-hi'>h</span>
              <span class='yuji-mai logo-setting-hi'>i</span>
              <span class='yuji-syuku logo-setting-n'>n</span>
            </div>
            <div class="mirror-horizontal animated-text-hanntenn"><p class='slackside-one'>g</p></div>
          </div>
          <div class="flex-between logo-blur-15">
            <div class="animated-text-sub-thing">
              <span class='zen-antique logo-setting'>S</span>
              <span class='sawarabi-mincho logo-setting'>u</span>
              <span class='dotgothic16'>b</span>
              <%# <span class='dotgothic16'>w</span> %>

              <span class='potta-one logo-setting-t logo-setting'>T</span>
              <span class='rocknroll-one logo-setting-hi'>h</span>
              <span class='yuji-mai logo-setting-hi'>i</span>
              <span class='yuji-syuku logo-setting-n'>n</span>
            </div>
            <div class="mirror-horizontal animated-text-hanntenn"><p class='slackside-one'>g</p></div>
          </div>
        </div>
      </div>
    </div>

          <div class="user-icon-frame-small">
            <% case @sub_user.icon_choice %>
              <% when 'sub_image' %>
                <!-- sub_image の内容を表示 -->
                <% if @sub_user.sub_image.present? %>
                  <%= image_tag @sub_user.sub_image.url, class: "item-icon-small" %>
                <% end %>
              <% when 'sub_canvas' %>
                <div class="canvas-container-parent">
                  <div class="back-white">
                    <img src="<%= @sub_user.sub_canvas %>" alt="Canvas Image" style="object-fit: contain;" class="item-icon-small">
                  </div>
                </div>
              <% when 'sub_color' %>
                <div style="background-color: <%= @sub_user.sub_color %>;" class="item-icon-small"></div>
              <% else %>
                <p>アイコンは設定されていません。</p>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="flex-between user-show-botann">
      <%= link_to new_item_path(sub_user_id: @sub_user.id), class: 'balloon-botann' do %>
        <div>
          <i class="bi bi-balloon-fill balloon-icon balloon-action"></i>
        </div>
        <div class="balloon-botann-text">
          New<br>
          Flow Thing
        </div>
      <% end %>


      <% if @item.image_choice.present? %>
        <% case @item.image_choice %>
        <% when 'item_image' %>
          <% if @item.item_image.present? %>
            <%= link_to edit_item_path(sub_user_id: @sub_user.id), class: 'balloon-botann' do %>  
              <div>
                <i class="bi bi-pen-fill pen-fill-icon"></i>
              </div>
              <div class="balloon-botann-text">
                Edit<br>
                Flow Thing
              </div>
            <% end %> 
          <% end %>

        <% when 'item_canvas' %>
          <%= link_to canvas_edit_item_path(id: @item.id, sub_user_id: @sub_user.id), class: 'balloon-botann' do %>  
            <div>
              <i class="bi bi-pen-fill pen-fill-icon"></i>
            </div>
            <div class="balloon-botann-text">
              Edit<br>
              Flow Paint
            </div>
          <% end %>

        <% else %>
          <%= link_to edit_item_path(sub_user_id: @sub_user.id), class: 'balloon-botann' do %>  
            <div>
              <i class="bi bi-pen-fill pen-fill-icon"></i>
            </div>
            <div class="balloon-botann-text">
              Edit<br>
              Flow Thing
            </div>
          <% end %> 
        <% end %>
      <% end %>



      <%= link_to item_new_board_boards_path(item_id: @item.id), class: "balloon-botann" do %>
        <div>
          <i class="bi bi-send-fill send-icon"></i>
        </div>
        <div class="balloon-botann-text">
          Item<br>
          Question
        </div>
      <% end %>
    </div>
  </div> 
  <div>
    <%= link_to item_path(@item), class: "trash-botann", data: { turbo_method: :delete, turbo_confirm: t('.delete_confirm') } do %>
      <div>
        <i class="bi bi-trash-fill trash-icon"></i>
      </div>
      <div class="trash-icon-text">
        Delete<br>
        Flow Thing？
      </div>
    <% end %>
  </div>
</div>